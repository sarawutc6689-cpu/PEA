<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏• | ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --primary-purple: #8b5cf6;
  --primary-purple-dark: #7c3aed;
  --primary-purple-light: #a78bfa;
  --gradient-purple: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  --light-purple: #f5f3ff;
  --white: #ffffff;
  --light-gray: #f8fafc;
  --border-color: #e2e8f0;
  --text-primary: #1e293b;
  --text-secondary: #64748b;
  --success: #10b981;
  --error: #ef4444;
  --shadow: 0 10px 25px rgba(139, 92, 246, 0.1);
  --shadow-hover: 0 15px 35px rgba(139, 92, 246, 0.2);
  --radius: 16px;
  --radius-lg: 24px;
  --transition: all 0.3s ease;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', 'Sukhumvit Set', 'Kanit', sans-serif;
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
  color: var(--text-primary);
  line-height: 1.6;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Header */
.header {
  background: var(--gradient-purple);
  padding: 20px 0;
  box-shadow: 0 4px 12px rgba(139, 92, 246, 0.25);
  position: relative;
  overflow: hidden;
}

.header::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
  background-size: 30px 30px;
  opacity: 0.3;
}

.header-content {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: relative;
  z-index: 1;
}

.logo {
  display: flex;
  align-items: center;
  gap: 12px;
  color: white;
  text-decoration: none;
}

.logo-icon {
  font-size: 28px;
  background: rgba(255, 255, 255, 0.2);
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.logo-text {
  font-size: 22px;
  font-weight: 700;
  letter-spacing: -0.5px;
}

.nav-links {
  display: flex;
  gap: 25px;
}

.nav-links a {
  color: rgba(255, 255, 255, 0.9);
  text-decoration: none;
  font-weight: 600;
  font-size: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: var(--transition);
  padding: 8px 16px;
  border-radius: 50px;
}

.nav-links a:hover {
  background: rgba(255, 255, 255, 0.15);
  color: white;
}

.nav-links a i {
  font-size: 18px;
}

/* Main Content */
.main-content {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
}

.container {
  width: 100%;
  max-width: 700px;
  margin: 0 auto;
}

.card {
  background: var(--white);
  border-radius: var(--radius-lg);
  padding: 40px;
  box-shadow: var(--shadow);
  transition: var(--transition);
}

.card:hover {
  box-shadow: var(--shadow-hover);
}

.card-header {
  text-align: center;
  margin-bottom: 40px;
  position: relative;
}

.card-header::after {
  content: '';
  position: absolute;
  bottom: -15px;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 4px;
  background: var(--gradient-purple);
  border-radius: 2px;
}

.card-title {
  font-size: 32px;
  font-weight: 700;
  color: var(--primary-purple-dark);
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
}

.card-title i {
  font-size: 36px;
  background: var(--light-purple);
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card-subtitle {
  color: var(--text-secondary);
  font-size: 16px;
  font-weight: 500;
}

/* Form */
.form-group {
  margin-bottom: 25px;
  position: relative;
}

.form-label {
  display: block;
  margin-bottom: 10px;
  font-weight: 600;
  color: var(--primary-purple-dark);
  font-size: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.form-label i {
  color: var(--primary-purple);
  font-size: 18px;
}

.required::after {
  content: ' *';
  color: var(--error);
}

.form-input, .form-textarea {
  width: 100%;
  padding: 18px 20px;
  font-size: 16px;
  border: 2px solid var(--border-color);
  border-radius: 12px;
  background: var(--light-gray);
  transition: var(--transition);
  font-family: inherit;
}

.form-input:focus, .form-textarea:focus {
  outline: none;
  border-color: var(--primary-purple);
  background: var(--white);
  box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.1);
}

.form-textarea {
  min-height: 120px;
  resize: vertical;
}

.input-icon {
  position: relative;
}

.input-icon i {
  position: absolute;
  left: 18px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--primary-purple);
  font-size: 18px;
}

.input-icon input {
  padding-left: 50px;
}

/* Button */
.submit-btn {
  background: var(--gradient-purple);
  color: white;
  border: none;
  padding: 20px;
  width: 100%;
  border-radius: 12px;
  font-size: 18px;
  font-weight: 700;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin-top: 10px;
  letter-spacing: 0.5px;
}

.submit-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 20px rgba(139, 92, 246, 0.3);
}

.submit-btn:active {
  transform: translateY(-1px);
}

/* Message */
.message {
  margin-top: 25px;
  padding: 18px;
  border-radius: 12px;
  text-align: center;
  font-weight: 600;
  display: none;
}

.message.success {
  background: rgba(16, 185, 129, 0.1);
  color: var(--success);
  border: 1px solid rgba(16, 185, 129, 0.3);
  display: block;
}

.message.error {
  background: rgba(239, 68, 68, 0.1);
  color: var(--error);
  border: 1px solid rgba(239, 68, 68, 0.3);
  display: block;
}

/* Footer */
.footer {
  background: var(--white);
  padding: 30px 0;
  border-top: 1px solid var(--border-color);
  margin-top: auto;
}

.footer-content {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
  text-align: center;
}

.footer-text {
  color: var(--text-secondary);
  font-size: 15px;
  margin-bottom: 10px;
}

.footer-links {
  display: flex;
  justify-content: center;
  gap: 25px;
  margin-top: 20px;
}

.footer-links a {
  color: var(--primary-purple);
  text-decoration: none;
  font-weight: 600;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 8px;
}

.footer-links a:hover {
  color: var(--primary-purple-dark);
  text-decoration: underline;
}

/* Responsive */
@media (max-width: 768px) {
  .header-content {
    flex-direction: column;
    gap: 15px;
  }
  
  .card {
    padding: 30px 25px;
  }
  
  .card-title {
    font-size: 28px;
  }
  
  .nav-links {
    gap: 15px;
  }
  
  .nav-links a {
    padding: 6px 12px;
    font-size: 15px;
  }
}

@media (max-width: 480px) {
  .card-title {
    font-size: 24px;
    flex-direction: column;
    gap: 10px;
  }
  
  .card-title i {
    width: 50px;
    height: 50px;
    font-size: 24px;
  }
  
  .nav-links {
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .form-input, .form-textarea {
    padding: 16px;
  }
}
</style>
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <a href="index.html" class="logo">
        <div class="logo-icon">
          <i class="fas fa-file-invoice-dollar"></i>
        </div>
        <div class="logo-text">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</div>
      </a>
      
      <nav class="nav-links">
        <nav class="nav-links">
                <a href="https://sarawutc6689-cpu.github.io/PEA/CheckBill.html" class="active">
                    <i class="fas fa-search"></i>
                    <span>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤/‡∏£‡∏±‡∏ö‡∏ö‡∏¥‡∏•</span>
                </a>
                <a href="https://sarawutc6689-cpu.github.io/PEA/Report.html">
                    <i class="fas fa-chart-bar"></i>
                    <span>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
                </a>
                <a href="https://sarawutc6689-cpu.github.io/PEA/AddBill.html">
                    <i class="fas fa-plus-circle"></i>
                    <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏¥‡∏•</span>
                </a>
                <a href="https://sarawutc6689-cpu.github.io/PEA/DashBoard.html">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
            </nav>
      </nav>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <div class="container">
      <div class="card">
        <div class="card-header">
          <h1 class="card-title">
            <i class="fas fa-plus-circle"></i>
            ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏•‡πÉ‡∏´‡∏°‡πà
          </h1>
          <p class="card-subtitle">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏•‡∏ï‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</p>
        </div>
        
        <form id="billForm">
          <div class="form-group">
            <label class="form-label required">
              <i class="fas fa-hashtag"></i>
              ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏¥‡∏•
            </label>
            <div class="input-icon">
              <i class="fas fa-receipt"></i>
              <input type="text" id="billNo" class="form-input" placeholder="">
            </div>
            <div class="form-hint">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏¥‡∏•‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô</div>
          </div>
          
          <div class="form-group">
            <label class="form-label required">
              <i class="fas fa-map-marker-alt"></i>
              ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
            </label>
            <div class="input-icon">
              <i class="fas fa-building"></i>
              <input type="text" id="place" class="form-input" placeholder="">
            </div>
            <div class="form-hint">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ç‡∏≠‡∏á‡∏ö‡∏¥‡∏•</div>
          </div>
          
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-align-left"></i>
              ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
            </label>
            <textarea id="detail" class="form-textarea" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏• ‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢, ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏, ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
            <div class="form-hint">‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</div>
          </div>
          
          <button type="button" class="submit-btn" onclick="save()">
            <i class="fas fa-save"></i>
            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏•
          </button>
        </form>
        
        <div id="msg" class="message"></div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <p class="footer-text">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à &copy; 2026 | ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ Sarawut.C</p>
      <p class="footer-text">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
    </div>
  </footer>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz6xj52pFOlDfvI9SvEPhhSrmvXnfmAsFLbqtaBlDDBN6gM0bQIvH-VuAwPaDd8Ke_r/exec";

async function save() {
  // Reset message
  const msg = document.getElementById("msg");
  msg.className = "message";
  msg.textContent = "";
  
  // Get form values
  const billNo = document.getElementById("billNo").value.trim();
  const place = document.getElementById("place").value.trim();
  const detail = document.getElementById("detail").value.trim();
  
  // Validation
  if (!billNo || !place) {
    msg.className = "message error";
    msg.innerHTML = '<i class="fas fa-exclamation-circle"></i> ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô';
    return;
  }
  
  // Show loading state
  const submitBtn = document.querySelector('.submit-btn');
  const originalBtnText = submitBtn.innerHTML;
  submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
  submitBtn.disabled = true;
  
  try {
    const res = await fetch(SCRIPT_URL, {
      method: "POST",
      body: JSON.stringify({
        action: "add",
        billNo,
        place,
        detail
      })
    });
    
    const data = await res.json();
    
    if (data.success) {
      msg.className = "message success";
      msg.innerHTML = '<i class="fas fa-check-circle"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß';
      
      // Reset form
      document.getElementById("billNo").value = "";
      document.getElementById("place").value = "";
      document.getElementById("detail").value = "";
      
      // Focus on first field
      document.getElementById("billNo").focus();
      
      // Auto hide message after 5 seconds
      setTimeout(() => {
        msg.style.opacity = '0';
        setTimeout(() => {
          msg.className = "message";
          msg.style.opacity = '1';
        }, 300);
      }, 5000);
    } else {
      msg.className = "message error";
      msg.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${data.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'}`;
    }
  } catch (error) {
    msg.className = "message error";
    msg.innerHTML = '<i class="fas fa-exclamation-circle"></i> ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå';
    console.error('Error:', error);
  } finally {
    // Restore button state
    submitBtn.innerHTML = originalBtnText;
    submitBtn.disabled = false;
  }
}

// Allow form submission with Enter key
document.addEventListener('DOMContentLoaded', function() {
  const inputs = document.querySelectorAll('.form-input, .form-textarea');
  
  inputs.forEach(input => {
    input.addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        if (input.id !== 'detail') {
          // Move to next field or submit
          const form = document.getElementById('billForm');
          const index = Array.from(inputs).indexOf(input);
          if (index < inputs.length - 1) {
            inputs[index + 1].focus();
          } else {
            save();
          }
        }
      }
    });
  });
  
  // Add form hints styling
  const style = document.createElement('style');
  style.textContent = `
    .form-hint {
      font-size: 14px;
      color: var(--text-secondary);
      margin-top: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .form-hint::before {
      content: 'üí°';
      font-size: 12px;
    }
  `;
  document.head.appendChild(style);
});
</script>
</body>
</html>
